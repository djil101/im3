<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Velometer Bahnhofplatz</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Slab:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <div class="location-selector">
            <img src="../img/chur.png" alt="Chur Wappen" class="logo">
            <div class="location-dropdown">
                <button onclick="toggleLocationDropdown()" class="location-dropdown-button">
                    <h1>Velometer<br><span class="location-text">Bahnhofplatz</span></h1>
                    <span class="dropdown-arrow">▼</span>
                </button>
                <div id="locationDropdown" class="location-dropdown-content">
                    <a href="#" onclick="selectLocation(event, 'Bahnhofplatz')" class="location-option selected">Bahnhofplatz</a>
                    <a href="#" onclick="selectLocation(event, 'Obere Au')" class="location-option">Obere Au</a>
                    <a href="#" onclick="selectLocation(event, 'Kantonsspital')" class="location-option">Kantonsspital</a>
                </div>
            </div>
        </div>


        <main>
            <section class="velos-available">
                <h2>Velos jetzt verfügbar:</h2>
                <div class="counter">0</div>
            </section>
            
                        <div class="scroll-indicator" onclick="scrollToStatistics()" style="cursor: pointer">
                <div class="arrow-down">▼</div>
            </div><br><br><br><br><br><br>

            <section class="statistics">
                <h2>Wie viele Velos hat es <br> üblicherweise?</h2>
                <div class="days-dropdown">
                    <button onclick="toggleDropdown()" class="dropdown-button">
                        Wochentage
                        <span class="dropdown-arrow">▼</span>
                    </button>
                    <div id="myDropdown" class="dropdown-content">
                        <a href="#" onclick="selectDay(event, 'Montag')" class="day-option">Montag</a>
                        <a href="#" onclick="selectDay(event, 'Dienstag')" class="day-option">Dienstag</a>
                        <a href="#" onclick="selectDay(event, 'Mittwoch')" class="day-option">Mittwoch</a>
                        <a href="#" onclick="selectDay(event, 'Donnerstag')" class="day-option">Donnerstag</a>
                        <a href="#" onclick="selectDay(event, 'Freitag')" class="day-option">Freitag</a>
                        <a href="#" onclick="selectDay(event, 'Samstag')" class="day-option">Samstag</a>
                        <a href="#" onclick="selectDay(event, 'Sonntag')" class="day-option">Sonntag</a>
                    </div>
                </div>
                

                <br><br><br><br><br>


                <div class="statistics-container">
                    <div class="graph-container">
                        <div class="graph">
                                <body>
                                    <canvas id="velometerChart"></canvas>
                                    <script src="../etl-boilerplate/script.js"></script> 
                                </body>
                        </div>
                    </div>

                    <section class="best-time">
                        <div>Heute der beste Zeitraum,<br>um ein Velo zu ergattern:</div>
                        <div class="time-box">
                            22:00 - 06:00 /<br> 14:00 - 16:00
                        </div>
                    </section>
                </div>
            </section>
        </main>

        <div>
            <img src="../img/hintergrund_bahnhofplatz.png" alt="" class="bg-top">
            <img src="../img/strasse.png" alt="" class="bg-bottom">
        </div>
    </div>

    <script>
        function scrollToStatistics() {
            const statistics = document.querySelector('.statistics');
            const topOffset = statistics.getBoundingClientRect().top + window.pageYOffset - 50;
            window.scrollTo({
                top: topOffset,
                behavior: 'smooth'
            });
        }

        function toggleLocationDropdown() {
            document.getElementById('locationDropdown').classList.toggle('show');
            const arrow = document.querySelector('.location-dropdown-button .dropdown-arrow');
            arrow.style.transform = arrow.style.transform === 'rotate(180deg)' ? 'rotate(0deg)' : 'rotate(180deg)';
        }

        function selectLocation(event, location) {
    event.preventDefault();
    
    // Remove selected class from all location options
    document.querySelectorAll('.location-option').forEach(option => {
        option.classList.remove('selected');
    });
    
    // Add selected class to clicked option
    event.target.classList.add('selected');
    
    // Update the location text
    document.querySelector('.location-text').textContent = location;
    
    // Change background image based on location
    const bgTop = document.querySelector('.bg-top');
    
    switch(location) {
        case 'Bahnhofplatz':
            bgTop.src = '../img/hintergrund_velometer.png';
            break;
        case 'Obere Au':
            bgTop.src = '../img/hintergrund_obere_au.png';
            break;
        case 'Kantonsspital':
            bgTop.src = '../img/hintergrund_kantonsspital.png';
            break;
    }
    
    // Close the dropdown
    document.getElementById('locationDropdown').classList.remove('show');
    
    // Reset arrow
    document.querySelector('.location-dropdown-button .dropdown-arrow').style.transform = 'rotate(0deg)';
}

        function toggleDropdown() {
            document.getElementById("myDropdown").classList.toggle("show");
            const arrow = document.querySelector('.dropdown-button .dropdown-arrow');
            arrow.style.transform = arrow.style.transform === 'rotate(180deg)' ? 'rotate(0deg)' : 'rotate(180deg)';
        }

        function selectDay(event, day) {
            event.preventDefault();
            // Remove selected class from all day options
            document.querySelectorAll('.day-option').forEach(option => {
                option.classList.remove('selected');
            });
            // Add selected class to clicked option
            event.target.classList.add('selected');
            
            // Update the button text while preserving the arrow
            const dropdownBtn = document.querySelector('.dropdown-button');
            dropdownBtn.innerHTML = day + '<span class="dropdown-arrow">▼</span>';
            
            // Close the dropdown and reset arrow
            document.getElementById("myDropdown").classList.remove("show");
            document.querySelector('.dropdown-button .dropdown-arrow').style.transform = 'rotate(0deg)';
        }

        // Close the dropdown if the user clicks outside of it
        window.onclick = function(event) {
            if (!event.target.matches('.dropdown-button') && !event.target.matches('.dropdown-arrow') &&
                !event.target.matches('.location-dropdown-button')) {
                const dropdowns = document.getElementsByClassName("dropdown-content");
                const locationDropdown = document.getElementById("locationDropdown");
                
                for (let dropdown of dropdowns) {
                    if (dropdown.classList.contains('show')) {
                        dropdown.classList.remove('show');
                    }
                }
                if (locationDropdown && locationDropdown.classList.contains('show')) {
                    locationDropdown.classList.remove('show');
                }
                
                // Reset all arrows
                const arrows = document.querySelectorAll('.dropdown-arrow');
                arrows.forEach(arrow => {
                    if (arrow.closest('.location-dropdown-button')) {
                        arrow.style.transform = 'rotate(0deg)';
                    } else {
                        arrow.style.transform = 'rotate(0deg)';
                    }
                });
            }
        }
    </script>